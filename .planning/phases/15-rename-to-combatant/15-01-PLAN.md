---
phase: 15-rename-to-combatant
plan: 01
type: execute
---

<objective>
Rename MercIcon and MercIconSmall to CombatantIcon and CombatantIconSmall, reflecting that these components display both mercs and dictators. Auto-detect combatant type from mercId prefix to remove need for explicit isDictator prop.

Purpose: Unify naming to reflect v1.2 architecture where both mercs and dictators are combatants handled by the same component.
Output: Renamed components with auto-detection, all consumers updated.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-image-path-fixes/14-01-SUMMARY.md

**Key files:**
@src/ui/components/MercIcon.vue
@src/ui/components/MercIconSmall.vue

**Consumers (9 files):**
- src/ui/components/MercCard.vue (MercIconSmall)
- src/ui/components/DrawEquipmentType.vue (MercIcon)
- src/ui/components/CombatPanel.vue (MercIcon)
- src/ui/components/SectorTile.vue (MercIconSmall)
- src/ui/components/DictatorPanel.vue (MercIconSmall)
- src/ui/components/SectorPanel.vue (MercIconSmall)
- src/ui/components/GameBoard.vue (MercIcon, MercIconSmall)

**Current pattern from v1.2:**
- Dictators have mercId prefixed with "dictator-" (e.g., `dictator-castro`)
- Both mercs and dictators pass `isDictator` prop explicitly to icons
- Icons use isDictator to determine folder (mercs/ vs dictators/) and extension (.jpg vs .png)

**Target pattern:**
- Components auto-detect from mercId prefix (`mercId?.startsWith('dictator-')`)
- isDictator prop becomes optional override, not required
- Naming reflects unified combatant handling
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename and enhance icon components</name>
  <files>src/ui/components/CombatantIcon.vue, src/ui/components/CombatantIconSmall.vue</files>
  <action>
1. Create CombatantIcon.vue by copying MercIcon.vue and:
   - Update CSS class from `.merc-icon` to `.combatant-icon`
   - Update internal comments to reference "combatant" not just "MERC"
   - Add auto-detection: `const autoDetectDictator = computed(() => props.mercId?.startsWith('dictator-') ?? false)`
   - Use `props.isDictator ?? autoDetectDictator.value` for folder/extension logic

2. Create CombatantIconSmall.vue by copying MercIconSmall.vue and:
   - Update CSS class from `.merc-icon-small` to `.combatant-icon-small`
   - Add same auto-detection logic
   - Use `props.isDictator ?? autoDetectDictator.value` for folder/extension logic

3. Delete original MercIcon.vue and MercIconSmall.vue
  </action>
  <verify>ls src/ui/components/ | grep -E "(Combatant|Merc)Icon" shows only CombatantIcon.vue and CombatantIconSmall.vue</verify>
  <done>Two new component files exist with auto-detection, old files deleted</done>
</task>

<task type="auto">
  <name>Task 2: Update all consumers</name>
  <files>src/ui/components/MercCard.vue, src/ui/components/DrawEquipmentType.vue, src/ui/components/CombatPanel.vue, src/ui/components/SectorTile.vue, src/ui/components/DictatorPanel.vue, src/ui/components/SectorPanel.vue, src/ui/components/GameBoard.vue</files>
  <action>
For each consumer file:
1. Update import statement: `MercIcon` → `CombatantIcon`, `MercIconSmall` → `CombatantIconSmall`
2. Update template usage: `<MercIcon` → `<CombatantIcon`, `<MercIconSmall` → `<CombatantIconSmall`
3. Remove `:is-dictator` prop from usages where mercId already contains the "dictator-" prefix (auto-detected)
4. Keep `:is-dictator` where explicit override is needed (rare - only if mercId doesn't follow convention)

**Files and changes:**
- MercCard.vue: Import CombatantIconSmall, update 1 template usage
- DrawEquipmentType.vue: Import CombatantIcon, update 1 template usage, remove isDictator prop (auto-detected from mercId)
- CombatPanel.vue: Import CombatantIcon, update 2 template usages, keep isDictatorSide prop for combat panel distinction
- SectorTile.vue: Import CombatantIconSmall, update 2 template usages
- DictatorPanel.vue: Import CombatantIconSmall, update 2 template usages
- SectorPanel.vue: Import CombatantIconSmall, update 5 template usages
- GameBoard.vue: Import both, update 2 template usages (1 each)
  </action>
  <verify>grep -r "MercIcon" src/ui/components/ returns no matches (except inside comments if any)</verify>
  <done>All imports and usages updated to Combatant*, no MercIcon references remain</done>
</task>

<task type="auto">
  <name>Task 3: Build verification</name>
  <files>-</files>
  <action>Run TypeScript build to ensure no import errors or type mismatches. The renamed components have the same props interface (isDictator is still accepted, just auto-detected when not provided).</action>
  <verify>npm run build passes without errors</verify>
  <done>Build succeeds, application compiles correctly</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] CombatantIcon.vue and CombatantIconSmall.vue exist
- [ ] MercIcon.vue and MercIconSmall.vue are deleted
- [ ] All 7 consumer files import from new component names
- [ ] All template usages updated to `<CombatantIcon` and `<CombatantIconSmall`
- [ ] `npm run build` passes
- [ ] grep "MercIcon" returns no results (except comments)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript or build errors
- Icon components renamed and enhanced with auto-detection
- Naming reflects unified combatant handling from v1.2 architecture
</success_criteria>

<output>
After completion, create `.planning/phases/15-rename-to-combatant/15-01-SUMMARY.md`
</output>
