---
phase: 07-file-organization
plan: 02
type: execute
---

<objective>
Split ai-helpers.ts (1,326 lines) into logical modules by AI strategy type.

Purpose: Reduce file size for faster IDE navigation, clearer code organization, and easier future maintenance.
Output: Multiple focused AI helper modules with a barrel export file.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/rules/ai-helpers.ts
@.planning/phases/07-file-organization/07-01-SUMMARY.md

**Constraints from v1.0:**
- Must maintain all existing exports
- Must not break any imports from other files
- All tests must continue to pass
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ai-combat-helpers.ts with combat-related AI</name>
  <files>src/rules/ai-combat-helpers.ts</files>
  <action>
    Extract from ai-helpers.ts:
    - calculateRebelStrength (lines 32-54)
    - chooseWeakestRebelSector (lines 61-84)
    - getRebelControlledSectors (lines 89-101)
    - CombatTarget interface and sortTargetsByAIPriority (lines 175-208)
    - detonateLandMines (lines 579-634)

    These are all combat/targeting related functions.
    Import game types and elements as needed.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>ai-combat-helpers.ts exists with 5+ functions exported, TypeScript compiles</done>
</task>

<task type="auto">
  <name>Task 2: Create ai-action-helpers.ts with action decision logic</name>
  <files>src/rules/ai-action-helpers.ts</files>
  <action>
    Extract from ai-helpers.ts (lines 709-978):
    - AIActionType type
    - AIActionDecision interface
    - sortMercsByInitiative
    - getSquadMercs
    - canSquadMoveTogether
    - getSquadAction
    - findUnoccupiedIndustriesInRange
    - getAIMercAction
    - getAIMercActionPriority
    - findClosestRebelSector
    - getBestMoveDirection

    This is the largest section - all about AI action decisions.
    Import game types and elements as needed.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>ai-action-helpers.ts exists with 11 exports, TypeScript compiles</done>
</task>

<task type="auto">
  <name>Task 3: Update ai-helpers.ts to use new modules and re-export</name>
  <files>src/rules/ai-helpers.ts</files>
  <action>
    1. Remove the extracted functions from ai-helpers.ts
    2. Import from new modules
    3. Re-export everything for backwards compatibility:
       - export * from './ai-combat-helpers.js'
       - export * from './ai-action-helpers.js'
    4. Keep remaining functions in ai-helpers.ts:
       - Distance calculations
       - Privacy player
       - Dictator movement
       - Base location
       - Militia distribution
       - Equipment sorting
       - MERC hiring
       - Auto-equip
       - Healing AI
       - Special abilities
       - Attack dogs/repair kits
       - Mortar targeting
  </action>
  <verify>npm run build && npm test</verify>
  <done>ai-helpers.ts reduced by ~400 lines, all imports still work, all tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] `npm test` passes all tests
- [ ] All existing imports of ai-helpers.ts work unchanged
- [ ] ai-helpers.ts is smaller than before (~900 lines)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No breaking changes to public API
- Code organization improved
- Phase 7 complete
</success_criteria>

<output>
After completion, create `.planning/phases/07-file-organization/07-02-SUMMARY.md`
</output>
