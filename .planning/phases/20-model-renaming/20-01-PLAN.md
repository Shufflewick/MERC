---
phase: 20-model-renaming
plan: 01
type: execute
---

<objective>
Rename CombatUnitCard class to CombatantModel and unify identity properties.

Purpose: Eliminate naming confusion between model classes (CombatUnitCard) and Vue components (MercCard.vue). Establish consistent `combatantId`/`combatantName` properties throughout the model layer.

Output: Renamed CombatantModel class with unified identity properties, backward-compatible getters maintained.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior context:**
- Phase 15 renamed icon components to CombatantIcon.vue/CombatantIconSmall.vue
- v1.2 unified MercCard/DictatorCard into CombatUnitCard with cardType discriminator
- v1.2 established property-based type guards (isMerc/isDictator getters)

**Key files:**
@src/rules/elements.ts - Contains CombatUnitCard, CombatUnit, MercCard, DictatorCard classes

**Architecture:**
- CombatUnit (abstract base): declares unitId/unitName
- CombatUnitCard (concrete): adds cardType discriminator, backward-compat getters
- MercCard/DictatorCard: thin wrappers that map mercId/dictatorId → unitId

**Established patterns:**
- cardType: 'merc' | 'dictator' discriminator
- isMerc/isDictator getter-based type guards
- Backward-compat getters for API stability
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename CombatUnit → CombatantBase and update identity properties</name>
  <files>src/rules/elements.ts</files>
  <action>
    1. Rename `CombatUnit` class to `CombatantBase`
    2. Change `declare unitId: string` → `declare combatantId: string`
    3. Change `declare unitName: string` → `declare combatantName: string`
    4. Add backward-compat getters: `get unitId() { return this.combatantId; }` and `get unitName() { return this.combatantName; }`
    5. Update all internal references within CombatantBase that use `this.unitId` → `this.combatantId`
    6. Update comment blocks to reflect new naming

    Keep the abstract class structure. The change is purely naming - no behavior changes.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit` passes</verify>
  <done>CombatantBase class exists with combatantId/combatantName properties and unitId/unitName backward-compat getters</done>
</task>

<task type="auto">
  <name>Task 2: Rename CombatUnitCard → CombatantModel</name>
  <files>src/rules/elements.ts</files>
  <action>
    1. Rename `CombatUnitCard` class to `CombatantModel`
    2. Update the class to extend `CombatantBase` (formerly CombatUnit)
    3. Update the backward-compat getters in CombatantModel:
       - Keep `get mercId()`, `get mercName()`, `get dictatorId()`, `get dictatorName()`
       - Change them to return `this.combatantId`/`this.combatantName` instead of `this.unitId`/`this.unitName`
    4. Update comment blocks and section headers

    Do NOT change MercCard/DictatorCard yet - that's in the next task.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit` passes</verify>
  <done>CombatantModel class exists extending CombatantBase, all backward-compat getters work</done>
</task>

<task type="auto">
  <name>Task 3: Update MercCard and DictatorCard subclasses</name>
  <files>src/rules/elements.ts</files>
  <action>
    1. Update MercCard to extend CombatantModel (instead of CombatUnitCard):
       - Keep `mercId!: string` and `mercName!: string` declarations (BoardSmith populates these)
       - Change the override getters: `get combatantId() { return this.mercId; }` and `get combatantName() { return this.mercName; }`
       - Remove the old `get unitId()` and `get unitName()` overrides (backward-compat is handled by base class now)

    2. Update DictatorCard similarly:
       - Keep `dictatorId!: string` and `dictatorName!: string` declarations
       - Change to: `get combatantId() { return this.dictatorId; }` and `get combatantName() { return this.dictatorName; }`
       - Remove old unitId/unitName overrides

    3. Update Squad class: change `all(MercCard)` references to use the correct pattern (Squad specifically works with mercs, keep MercCard reference for now)

    The subclasses still exist because BoardSmith JSON loading maps different field names:
    - mercs.json uses id→mercId, name→mercName
    - dictators use id→dictatorId, name→dictatorName
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit` passes</verify>
  <done>MercCard/DictatorCard extend CombatantModel, provide combatantId/combatantName via getters</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] `npm test` passes (all existing tests work)
- [ ] Class hierarchy: CombatantBase (abstract) → CombatantModel → MercCard/DictatorCard
- [ ] All backward-compat getters work (unitId, unitName, mercId, mercName, dictatorId, dictatorName)
</verification>

<success_criteria>
- CombatantBase and CombatantModel classes exist with correct hierarchy
- combatantId/combatantName are the canonical identity properties
- All backward-compat getters maintained for API stability
- TypeScript compiles without errors
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/20-model-renaming/20-01-SUMMARY.md`
</output>
