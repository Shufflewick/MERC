---
phase: 25-remove-id-aliases
plan: 01
type: execute
---

<objective>
Remove mercId/mercName/dictatorId/dictatorName/unitId/unitName alias properties from class hierarchy.

Purpose: Unify on combatantId/combatantName as the sole identity properties for all combatants.
Output: CombatantModel uses _combatantId/_combatantName directly; MercCard/DictatorCard no longer have their own ID properties.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary-frontmatter.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-merge-classes/24-01-SUMMARY.md

@src/rules/elements.ts
@src/rules/game.ts
@src/rules/setup.ts

**Background:**
Phase 24 made CombatantModel concrete with `_combatantId`/`_combatantName` properties. MercCard/DictatorCard currently delegate via getters that prefer their own properties (mercId/dictatorId) with fallback to parent.

**Current state:**
- CombatantBase has abstract `combatantId`/`combatantName` getters, plus backward-compat `unitId`/`unitName` aliases
- CombatantModel has `_combatantId`/`_combatantName` properties with getters/setters
- MercCard has `mercId!`/`mercName!` properties populated from JSON, getters return `mercId || _combatantId`
- DictatorCard has `dictatorId!`/`dictatorName!` properties populated from JSON, getters return `dictatorId || _combatantId`

**Target state:**
- CombatantBase: Remove unitId/unitName aliases (handled in Plan 02/03 where usages are removed)
- CombatantModel: Keep _combatantId/_combatantName as the source of truth
- MercCard: Remove mercId/mercName properties, use parent's combatantId/combatantName
- DictatorCard: Remove dictatorId/dictatorName properties, use parent's combatantId/combatantName
- game.ts: Map JSON `id`/`name` to `combatantId`/`combatantName`
- setup.ts: Map dictator JSON `id`/`name` to `combatantId`/`combatantName`

**Constraint:**
All 300+ usages of .mercId, .mercName, .dictatorId, .dictatorName, .unitId, .unitName in rules/ and ui/ and tests/ must be updated BEFORE the properties are removed. This plan ONLY changes the class definitions and data loading - NOT the usages (handled in Plan 02 and 03).

**Strategy:**
This plan prepares the ground by:
1. Adding temporary re-export getters for mercId/mercName/dictatorId/dictatorName that delegate to combatantId/combatantName
2. Updating data loading to use combatantId/combatantName
3. Leaving unitId/unitName aliases in place (removed after all usages updated)

This allows Plans 02/03 to do the bulk renaming, then Plan 04 will remove the temporary getters.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update MercCard to use parent identity with backward-compat getters</name>
  <files>src/rules/elements.ts</files>
  <action>
In MercCard class:
1. Remove `mercId!: string;` and `mercName!: string;` property declarations
2. Change combatantId getter/setter to use parent directly:
   - `override get combatantId(): string { return this._combatantId; }`
   - `override set combatantId(value: string) { this._combatantId = value; }`
3. Change combatantName getter/setter similarly:
   - `override get combatantName(): string { return this._combatantName; }`
   - `override set combatantName(value: string) { this._combatantName = value; }`
4. Add backward-compat getters that delegate to combatantId/combatantName:
   ```typescript
   // Backward-compat aliases - TEMPORARY, remove in Phase 25 Plan 04
   get mercId(): string { return this.combatantId; }
   set mercId(value: string) { this.combatantId = value; }
   get mercName(): string { return this.combatantName; }
   set mercName(value: string) { this.combatantName = value; }
   ```

Note: The backward-compat getters ensure existing code continues to work until Plan 02/03 complete the rename.
  </action>
  <verify>TypeScript compiles without errors: `npm run build`</verify>
  <done>MercCard uses parent combatantId/combatantName with backward-compat mercId/mercName getters</done>
</task>

<task type="auto">
  <name>Task 2: Update DictatorCard to use parent identity with backward-compat getters</name>
  <files>src/rules/elements.ts</files>
  <action>
In DictatorCard class:
1. Remove `dictatorId!: string;` and `dictatorName!: string;` property declarations
2. Change combatantId getter/setter to use parent directly:
   - `override get combatantId(): string { return this._combatantId; }`
   - `override set combatantId(value: string) { this._combatantId = value; }`
3. Change combatantName getter/setter similarly:
   - `override get combatantName(): string { return this._combatantName; }`
   - `override set combatantName(value: string) { this._combatantName = value; }`
4. Add backward-compat getters that delegate to combatantId/combatantName:
   ```typescript
   // Backward-compat aliases - TEMPORARY, remove in Phase 25 Plan 04
   get dictatorId(): string { return this.combatantId; }
   set dictatorId(value: string) { this.combatantId = value; }
   get dictatorName(): string { return this.combatantName; }
   set dictatorName(value: string) { this.combatantName = value; }
   ```

Note: The backward-compat getters ensure existing code continues to work until Plan 02/03 complete the rename.
  </action>
  <verify>TypeScript compiles without errors: `npm run build`</verify>
  <done>DictatorCard uses parent combatantId/combatantName with backward-compat dictatorId/dictatorName getters</done>
</task>

<task type="auto">
  <name>Task 3: Update data loading to use combatantId/combatantName</name>
  <files>src/rules/game.ts, src/rules/setup.ts</files>
  <action>
In game.ts loadCombatantData():
- Change `mercId: merc.id,` to `combatantId: merc.id,`
- Change `mercName: merc.name,` to `combatantName: merc.name,`

In setup.ts setupDictator():
- Change `dictatorId: selectedDictator.id,` to `combatantId: selectedDictator.id,`
- Change `dictatorName: selectedDictator.name,` to `combatantName: selectedDictator.name,`

This ensures new combatants are created with combatantId/combatantName populated, not the old alias properties.
  </action>
  <verify>
1. `npm run build` passes
2. `npm test` passes - all tests should still work due to backward-compat getters
  </verify>
  <done>Data loading uses combatantId/combatantName; backward-compat getters keep existing code working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes all tests
- [ ] MercCard.mercId returns same value as MercCard.combatantId
- [ ] DictatorCard.dictatorId returns same value as DictatorCard.combatantId
</verification>

<success_criteria>
- MercCard no longer has mercId!/mercName! property declarations
- DictatorCard no longer has dictatorId!/dictatorName! property declarations
- Data loading uses combatantId/combatantName
- Backward-compat getters ensure no runtime breakage
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/25-remove-id-aliases/25-01-SUMMARY.md`
</output>
