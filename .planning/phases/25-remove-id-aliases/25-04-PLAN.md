---
phase: 25-remove-id-aliases
plan: 04
type: execute
---

<objective>
Remove backward-compat alias getters from MercCard, DictatorCard, and CombatantBase.

Purpose: Complete the cleanup by removing temporary backward-compat getters.
Output: Clean class hierarchy with only combatantId/combatantName - no aliases.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary-frontmatter.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/25-remove-id-aliases/25-03-SUMMARY.md

**Depends on:** Plan 25-03 (all usages updated)

**Current state after Plans 01-03:**
- MercCard has backward-compat `mercId`/`mercName` getters → remove
- DictatorCard has backward-compat `dictatorId`/`dictatorName` getters → remove
- CombatantBase has backward-compat `unitId`/`unitName` getters → remove

**Final state:**
- CombatantBase: abstract `combatantId`/`combatantName` getters only
- CombatantModel: `_combatantId`/`_combatantName` with getters/setters
- MercCard: inherits from CombatantModel, no overrides needed
- DictatorCard: inherits from CombatantModel, no overrides needed
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove backward-compat getters from MercCard and DictatorCard</name>
  <files>src/rules/elements.ts</files>
  <action>
In MercCard class, remove the backward-compat getter/setter block:
```typescript
// Backward-compat aliases - TEMPORARY, remove in Phase 25 Plan 04
get mercId(): string { return this.combatantId; }
set mercId(value: string) { this.combatantId = value; }
get mercName(): string { return this.combatantName; }
set mercName(value: string) { this.combatantName = value; }
```

Also remove the override getters since MercCard can now just inherit:
```typescript
override get combatantId(): string { return this._combatantId; }
override set combatantId(value: string) { this._combatantId = value; }
override get combatantName(): string { return this._combatantName; }
override set combatantName(value: string) { this._combatantName = value; }
```

MercCard becomes a thin subclass that only sets `cardType = 'merc'`.

In DictatorCard class, same removal:
- Remove backward-compat dictatorId/dictatorName getters/setters
- Remove override combatantId/combatantName getters/setters

DictatorCard becomes a thin subclass that sets `cardType = 'dictator'` and `inPlay = false`.
  </action>
  <verify>`npm run build` passes</verify>
  <done>MercCard and DictatorCard no longer have alias getters</done>
</task>

<task type="auto">
  <name>Task 2: Remove unitId/unitName aliases from CombatantBase</name>
  <files>src/rules/elements.ts</files>
  <action>
In CombatantBase class, remove the backward-compat aliases:
```typescript
// Backward-compat getters for API stability
get unitId(): string { return this.combatantId; }
get unitName(): string { return this.combatantName; }
```

These are no longer needed since all code now uses combatantId/combatantName.
  </action>
  <verify>
1. `npm run build` passes
2. `npm test` passes
  </verify>
  <done>CombatantBase has no alias getters; only combatantId/combatantName exist</done>
</task>

<task type="auto">
  <name>Task 3: Update CLAUDE.md documentation</name>
  <files>CLAUDE.md</files>
  <action>
Update the CLAUDE.md Class Hierarchy section to reflect the simplified structure:

Remove mentions of:
- mercId/mercName from MercCard description
- dictatorId/dictatorName from DictatorCard description
- unitId/unitName backward-compat aliases

Update the Identity Properties section:
- Remove "mercId/mercName and dictatorId/dictatorName are JSON-populated"
- Remove "unitId/unitName are backward-compat aliases (prefer combatantId)"
- Simplify to just "Use combatantId/combatantName for all combatant identity"

Update the Common Tasks section:
- Change `game.first(MercCard, m => m.mercId === 'haarg')` to `game.first(MercCard, m => m.combatantId === 'haarg')`
  </action>
  <verify>Documentation accurately reflects the new class structure</verify>
  <done>CLAUDE.md updated to reflect unified combatantId/combatantName</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes all tests
- [ ] `grep -r "mercId\|mercName\|dictatorId\|dictatorName\|unitId\|unitName" src/rules/elements.ts` returns no matches
- [ ] CLAUDE.md reflects the simplified class hierarchy
</verification>

<success_criteria>
- MercCard and DictatorCard are thin subclasses with no ID aliases
- CombatantBase has no unitId/unitName aliases
- Only combatantId/combatantName exist throughout the codebase
- CLAUDE.md documentation updated
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/25-remove-id-aliases/25-04-SUMMARY.md`

The summary should note:
- Phase 25 complete: ID aliases eliminated
- combatantId/combatantName are now the only identity properties
- Ready for Phase 26 (Update References) or milestone completion
</output>
