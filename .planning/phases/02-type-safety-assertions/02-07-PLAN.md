---
phase: 02-type-safety-assertions
plan: 07
type: execute
---

<objective>
Fix type assertions in day-one-actions.ts.

Purpose: Eliminate 60 unsafe type assertions in day one setup actions.
Output: Properly typed day-one-actions.ts using assertion helpers and type narrowing.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./02-07-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-type-safety-assertions/02-01-SUMMARY.md
@.planning/phases/02-type-safety-assertions/02-06-SUMMARY.md

@src/rules/actions/day-one-actions.ts
@src/rules/actions/helpers.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix day-one-actions.ts player assertions</name>
  <files>src/rules/actions/day-one-actions.ts</files>
  <action>
Fix player-related assertions (~25):
- `game.isRebelPlayer(ctx.player as any)` - Remove `as any`
- `player as RebelPlayer` - Use type narrowing after check
- `ctx.player as RebelPlayer` - Same pattern

Apply consistent pattern from previous plans.
  </action>
  <verify>`grep -c "player as any" src/rules/actions/day-one-actions.ts` returns 0</verify>
  <done>Player assertions fixed, no `as any` for player casts</done>
</task>

<task type="auto">
  <name>Task 2: Fix day-one-actions.ts element and args assertions</name>
  <files>src/rules/actions/day-one-actions.ts</files>
  <action>
Fix remaining assertions (~35):

**Element casts:**
- `element as unknown as Sector` - Use `asSector()` helper
- `element as unknown as RebelPlayer` - For player selection

**Args casts:**
- `args.merc as string` - Safe for string choices
- `args.equipmentType as 'Weapon' | 'Armor' | 'Accessory'` - Safe for known union
- `args.sector as Sector` - Use helper
- `args.baseLocation as Sector` - Use helper
- `args.dictatorChoice as string` - Safe
- `args.targetSector as string` - Safe
- `args.amount as string` - Safe
- `args.player as RebelPlayer` - Use helper

**Settings casts:**
- `game.settings[key] as number[]` - Generally safe
- `game.settings[key] as number` - Generally safe
- `game.settings[key] as number | undefined` - Safe pattern

**getElementById casts:**
- `game.getElementById(id) as MercCard` - Use helper
- `game.dictatorData as DictatorData[]` - Check if typing exists

**Display callback:**
- `player as unknown as RebelPlayer` - For display callback, reasonable pattern
  </action>
  <verify>
1. `npx tsc --noEmit` passes
2. `npm test` passes
3. No `as any` patterns
  </verify>
  <done>day-one-actions.ts assertions fixed with proper type handling</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes
- [ ] `npm test` passes
- [ ] No `as any` in day-one-actions.ts
- [ ] Reduced unsafe patterns
</verification>

<success_criteria>

- day-one-actions.ts uses proper type assertions
- No `as any` casts
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/02-type-safety-assertions/02-07-SUMMARY.md`
</output>
