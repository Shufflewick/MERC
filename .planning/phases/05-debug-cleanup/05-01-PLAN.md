---
phase: 05-debug-cleanup
plan: 01
type: execute
---

<objective>
Remove DEBUG messages from game output and ensure debug features are properly gated.

Purpose: Players should never see DEBUG output. Debug development tools should be clearly marked and harmless if accidentally enabled.
Output: Clean game message output with no visible debug strings, properly gated debug configuration.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Source files to modify:
@src/rules/actions/dictator-actions.ts
@src/rules/setup.ts
@src/rules/debug-config.ts

**From CONCERNS.md - Debug issues to address:**
- DEBUG messages visible to players (dictator-actions.ts:426, 430)
- DEBUG_TACTICS_ORDER can override random card order (debug-config.ts, setup.ts)

**Constraint:** Per CLAUDE.md - do not remove debug code without confirming the problem it was diagnosing is fixed. These DEBUG messages appear to be from troubleshooting sector name matching during MERC placement. The fix is in place (regex extraction + fallback matching), so these can be removed.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove DEBUG messages from dictator-actions.ts</name>
  <files>src/rules/actions/dictator-actions.ts</files>
  <action>
Remove the two debug message lines:
- Line 426: `game.message(\`DEBUG: Raw targetSector arg = ...\`)`
- Line 430: `game.message(\`DEBUG: Extracted sector name = ...\`)`

Keep the WARNING message on line 443 - that's a legitimate runtime warning for a fallback condition, not debug output.

Do NOT remove any other code. Just delete these two specific debug lines.
  </action>
  <verify>grep -n "DEBUG:" src/rules/actions/dictator-actions.ts returns no matches</verify>
  <done>No DEBUG: prefixed messages in dictator-actions.ts</done>
</task>

<task type="auto">
  <name>Task 2: Gate DEBUG_TACTICS_ORDER message in setup.ts</name>
  <files>src/rules/setup.ts</files>
  <action>
The DEBUG_TACTICS_ORDER feature itself is fine - it's useful for testing specific tactics cards. However:
1. The `[DEBUG]` prefix in the message (line 369) makes it obvious this is debug output
2. Keep this message as-is - it correctly signals when debug mode is active
3. Add a comment above the debug-config import explaining the feature is for testing only

The current implementation is already properly gated (only fires when effectiveDebugOrder is non-null), and the message serves as a clear indicator when debug mode is active. No code change needed to the message itself.

Add a brief comment at the debug-config import (line 21) noting this is for testing purposes only.
  </action>
  <verify>
1. grep -n "DEBUG_TACTICS_ORDER" src/rules/setup.ts shows import and usage
2. The debug message only appears when debug order is set (as designed)
  </verify>
  <done>DEBUG_TACTICS_ORDER import has a comment explaining it's for testing only</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `grep -rn "game.message.*DEBUG" src/rules/` returns only the gated setup.ts message
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes all tests
</verification>

<success_criteria>

- No ungated DEBUG messages visible to players during normal gameplay
- Debug deck stacking feature documented as test-only
- All existing tests pass
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/05-debug-cleanup/05-01-SUMMARY.md`
</output>
