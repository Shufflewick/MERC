# Milestone v1.7: GameBoard Component Refactor

**Status:** SHIPPED 2026-01-19
**Phases:** 31-36
**Total Plans:** 18

## Overview

Refactored GameBoard.vue (3,368 lines) into focused, testable components with clean boundaries. Extracted state derivation to composables, UI flows to components, and reduced GameBoard to thin orchestrator role.

## Phases

### Phase 31: Helper Composables

**Goal:** Extract pure utility functions that have no dependencies on Vue reactivity or game state.
**Plans:** 3 plans

Plans:
- [x] 31-01: Create useGameViewHelpers composable
- [x] 31-02: Create useVictoryCalculations composable
- [x] 31-03: Integrate composables into GameBoard.vue

**Deliverables:**
- `src/ui/composables/useGameViewHelpers.ts`
- `src/ui/composables/useVictoryCalculations.ts`

---

### Phase 32: State Composables

**Goal:** Extract reactive state derivation into composables that can be shared across components.
**Plans:** 5 plans

Plans:
- [x] 32-01: Create usePlayerState composable
- [x] 32-02: Create useSectorState composable
- [x] 32-03: Create useSquadState composable
- [x] 32-04: Create useActionState composable
- [x] 32-05: Integrate all state composables

**Deliverables:**
- `src/ui/composables/usePlayerState.ts` (163 lines)
- `src/ui/composables/useSectorState.ts` (454 lines)
- `src/ui/composables/useSquadState.ts` (426 lines)
- `src/ui/composables/useActionState.ts` (639 lines)

---

### Phase 33: Small UI Components

**Goal:** Extract simple, self-contained UI components with minimal logic.
**Plans:** 3 plans

Plans:
- [x] 33-01: Create GameOverOverlay component
- [x] 33-02: Create LandingZoneSelection component
- [x] 33-03: Integrate components into GameBoard.vue

**Deliverables:**
- `src/ui/components/GameOverOverlay.vue` (108 lines)
- `src/ui/components/LandingZoneSelection.vue` (117 lines)

---

### Phase 34: Hagness UI Component

**Goal:** Extract the Hagness draw equipment flow into a dedicated component.
**Plans:** 2 plans

Plans:
- [x] 34-01: Create HagnessDrawEquipment component
- [x] 34-02: Integrate component into GameBoard.vue

**Deliverables:**
- `src/ui/components/HagnessDrawEquipment.vue` (188 lines)

---

### Phase 35: Hiring Phase Component

**Goal:** Extract the complex hiring phase UI into a dedicated component.
**Plans:** 2 plans

Plans:
- [x] 35-01: Create HiringPhase component
- [x] 35-02: Integrate component into GameBoard.vue

**Deliverables:**
- `src/ui/components/HiringPhase.vue` (306 lines)

---

### Phase 36: Integration & Cleanup

**Goal:** Final integration, cleanup, and verification that GameBoard.vue is now an orchestrator.
**Plans:** 3 plans

Plans:
- [x] 36-01: Dead code removal and import organization
- [x] 36-02: TypeScript cast audit
- [x] 36-03: Verification and test suite

**Results:**
- GameBoard.vue: 3,368 â†’ 1,393 lines (59% reduction)
- All 524 tests passing
- All 6 composables integrated
- All 4 components integrated

---

## Milestone Summary

**Key Decisions:**
- Extract state to composables (shared across components)
- Extract UI flows to components (HiringPhase, HagnessDrawEquipment, etc.)
- Keep GameBoard as orchestrator (not <500 lines, but proper separation)
- Watch both availableActions AND currentAction for auto-start (fixes action chaining)
- Match choices by display name, fill with element ID (ActionPanel pattern)

**Issues Resolved:**
- Landing zone selection not advancing (choice matching fixed)
- Hiring phase not auto-starting (watcher now watches currentAction too)
- Dead code accumulation (removed unused imports and functions)

**Issues Deferred:**
- GameBoard.vue still 1,393 lines (above 500 target but functioning as orchestrator)
- selectedMercForEquipment warning (benign - merc not in tree during hiring)
- Vendor tarball packaging (pre-existing infrastructure issue)

**Technical Debt:**
- Some TypeScript type mismatches with external @boardsmith packages
- Build blocked by vendor tarball dist folder issue

---

*For current project status, see .planning/PROJECT.md*
