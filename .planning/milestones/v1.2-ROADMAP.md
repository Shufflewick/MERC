# Milestone v1.2: Merge Dictator and Merc Cards

**Status:** ✅ SHIPPED 2026-01-11
**Phases:** 9-13
**Total Plans:** 7

## Overview

Unified MercCard and DictatorCard into a single CombatUnitCard class with discriminator-based logic, eliminating duplicate class definitions and replacing 103 instanceof checks with property-based type guards.

## Phases

### Phase 9: Add Discriminator

**Goal**: Add cardType property to existing classes without breaking anything
**Depends on**: Previous milestone complete
**Plans**: 1 plan

Plans:
- [x] 09-01: Add cardType discriminator to MercCard/DictatorCard — completed 2026-01-11

**Details:**
Added `cardType: 'merc' | 'dictator'` field to data files and class properties. Added `isMerc` and `isDictator` getter methods to both classes.

### Phase 10: Unified Class

**Goal**: Create CombatUnitCard class and make old classes thin aliases
**Depends on**: Phase 9
**Plans**: 1 plan

Plans:
- [x] 10-01: Create CombatUnitCard class — completed 2026-01-11

**Details:**
Created CombatUnitCard extending CombatUnit with all unified functionality. Made MercCard and DictatorCard thin wrappers extending CombatUnitCard. Full backward compatibility maintained.

### Phase 11: Migrate instanceof

**Goal**: Replace 103 instanceof checks with property-based type guards
**Depends on**: Phase 10
**Plans**: 3 plans

Plans:
- [x] 11-01: Type guards and combat.ts migration — completed 2026-01-11
- [x] 11-02: Actions directory migration — completed 2026-01-11
- [x] 11-03: Other files migration — completed 2026-01-11

**Details:**
Added isCombatUnitCard, isMercCard type guards to helpers.ts. Migrated all 103 instanceof checks to property-based checks using isMerc/isDictator. Improved bundler compatibility.

### Phase 12: Merge Data Files

**Goal**: Combine mercs.json and dictators.json into combatants.json
**Depends on**: Phase 11
**Plans**: 1 plan

Plans:
- [x] 12-01: Merge data files — completed 2026-01-11

**Details:**
Created unified data/combatants.json with all 54 entries (52 mercs + 2 dictators). Replaced MercData/DictatorData with unified CombatantData interface. Single loadCombatantData method replaces two separate loaders.

### Phase 13: Remove Legacy

**Goal**: Remove old data files and fix remaining legacy references
**Depends on**: Phase 12
**Plans**: 1 plan

Plans:
- [x] 13-01: Delete old data files and fix references — completed 2026-01-11

**Details:**
Deleted mercs.json and dictators.json. Updated all code references to use combatantData with cardType filter. Updated comments to reference combatants.json.

---

## Milestone Summary

**Key Decisions:**
- cardType discriminator: `'merc' | 'dictator'` string literal union
- CombatUnitCard in inheritance chain between CombatUnit and MercCard/DictatorCard
- inPlay defaults to true in CombatUnitCard, overridden to false in DictatorCard
- Property-based type guards: isCombatUnitCard, isMercCard, isDictatorCard in helpers.ts
- Pattern: Use optional chaining (`?.isMerc`) instead of instanceof for bundler compatibility
- Pattern: Access dictator data via combatantData.filter(d => d.cardType === 'dictator')

**Issues Resolved:**
- Eliminated 103 instanceof checks causing bundler issues
- Unified two separate data files into one source of truth
- Removed duplicate class definitions and logic

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
