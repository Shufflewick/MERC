# Milestone v1.10: Grievances

**Status:** SHIPPED 2026-02-09
**Phases:** 47-50
**Total Plans:** 9

## Overview

Fix gameplay bugs, missing implementations, and UI inconsistencies so the game plays correctly and visibly. Four phases address equipment slot bugs, a missing landmine trigger system, inconsistent sector panel wiring, and incomplete dictator tactics card implementations.

## Phases

### Phase 47: Equipment Slot Cleanup

**Goal**: Bandolier equipment behaves correctly when replaced or removed
**Depends on**: Nothing (self-contained bug fix)
**Requirements**: EQUIP-01, EQUIP-02
**Success Criteria** (what must be TRUE):
  1. When a MERC replaces their bandolier with a different accessory, all items in bandolier slots are returned to the sector stash
  2. When a MERC no longer has a bandolier equipped, the bandolier slots are removed and no phantom slots remain
  3. Existing tests continue to pass (no regressions in equipment handling)
**Plans**: 2 plans

Plans:
- [x] 47-01-PLAN.md -- TDD: Fix equip() return type to include displaced bandolier items
- [x] 47-02-PLAN.md -- Update all equip() callers to handle EquipResult

### Phase 48: Landmine System

**Goal**: Landmines in sector stashes trigger correctly when enemies enter, with Squidhead counter-ability
**Depends on**: Nothing (self-contained rules system)
**Requirements**: MINE-01, MINE-02, MINE-03, MINE-04
**Success Criteria** (what must be TRUE):
  1. When an enemy squad or combatant enters a sector containing a landmine in the stash, the landmine detonates
  2. A detonated landmine deals 1 damage to every enemy combatant present in the sector
  3. After detonation, the landmine is removed from the sector stash (discarded)
  4. When Squidhead is present in the sector, the landmine does not detonate
**Plans**: 2 plans

Plans:
- [x] 48-01-PLAN.md -- TDD: Create checkLandMines() bidirectional trigger function with tests
- [x] 48-02-PLAN.md -- Wire checkLandMines into movement actions, remove old combat.ts call

### Phase 49: Sector Panel Audit

**Goal**: Every action launched from the sector panel works identically to its action panel counterpart
**Depends on**: Nothing (UI wiring audit, independent of rules changes)
**Requirements**: SECT-01, SECT-02, SECT-03
**Success Criteria** (what must be TRUE):
  1. Every sector panel action prepopulates the selected sector as context (no manual re-selection)
  2. Sector panel actions show the same combatant options that the corresponding action panel shows
  3. All sector panel actions have been audited and any wiring inconsistencies fixed
**Plans**: 1 plan

Plans:
- [x] 49-01-PLAN.md -- Fix auto-fill format mismatch, add coordinatedAttack pre-fill, remove debug logging

### Phase 50: Tactics Card Audit

**Goal**: Every dictator tactics card is correctly implemented with visible animations
**Depends on**: Nothing (independent audit and implementation work)
**Requirements**: TACT-01, TACT-02, TACT-03, TACT-04, TACT-05, TACT-06, TACT-07, TACT-08
**Success Criteria** (what must be TRUE):
  1. Every dictator tactics card has been audited and verified or fixed for correct implementation
  2. Every dictator tactics card plays a meaningful visible animation when executed
  3. Generalissimo draws 6 mercs and lets the dictator pick 1 to add to either squad
  4. Better Weapons gives militia a persistent buff to hit on 3+ going forward
  5. Lockdown lets the dictator place 5 extra militia on base or adjacent sectors
**Plans**: 4 plans

Plans:
- [x] 50-01-PLAN.md -- Remove fabricated base defense bonuses, fix Block Trade militia placement
- [x] 50-02-PLAN.md -- Add animations to all 12 working tactics effects + GameTable.vue handlers
- [x] 50-03-PLAN.md -- Rewrite Generalissimo: draw 6 MERCs, pick 1, add to squad
- [x] 50-04-PLAN.md -- Rewrite Lockdown: place 5*rebelCount militia on base/adjacent sectors

## Progress

**Execution Order:** 47 -> 48 -> 49 -> 50

| Phase | Plans Complete | Status | Completed |
|-------|---------------|--------|-----------|
| 47. Equipment Slot Cleanup | 2/2 | Complete | 2026-02-08 |
| 48. Landmine System | 2/2 | Complete | 2026-02-08 |
| 49. Sector Panel Audit | 1/1 | Complete | 2026-02-08 |
| 50. Tactics Card Audit | 4/4 | Complete | 2026-02-09 |

---

## Milestone Summary

**Key Decisions:**

- equip() returns EquipResult instead of Equipment | undefined (compiler-enforced pit of success for bandolier handling)
- All equip() callers destructure EquipResult and route displaced bandolier items to stash or discard
- Friendly mine heuristic: mine is friendly when entering player has militia AND no enemies (exclusive sector control)
- Auto-disarm always discards mine to accessory discard pile (never equip on Squidhead, never leave in stash)
- SectorPanel auto-fill uses sel.type === 'choice' (not sel.name) for chooseFrom format detection
- Fabricated base defense bonuses (generalisimoActive/lockdownActive) removed entirely -- no basis in CSV rules
- Block Trade places militia on ALL cities (not just newly flipped) per CSV wording "each city"
- Tactics animation: artillery barrage uses pure UI signal (empty callback) since mutations happen through allocation flow
- Single activeTacticEvent ref in GameTable.vue shared across all 12 event types (loop-based registration)
- Generalissimo AI auto-picks highest baseCombat MERC (same heuristic as Castro)
- Lockdown AI distributes militia round-robin across base + adjacent sectors for even distribution

**Issues Resolved:**

- Bandolier phantom slots on equipment replacement (equip() callers ignored displaced items)
- Landmine system not triggered on movement (old code only in combat.ts, never actually worked)
- Sector panel auto-fill format mismatch (element ID vs chooseFrom string format)
- coordinatedAttack pre-fill using wrong selection name ('destination' vs 'target')
- Fabricated generalisimoActive/lockdownActive combat bonuses with no basis in game rules
- Block Trade only placing militia on newly flipped cities instead of all cities
- Missing animations on 12 of 14 tactics cards
- Generalissimo not implemented (hardcoded to do nothing useful)
- Lockdown not implemented (hardcoded to do nothing useful)

**Issues Deferred:**

- Vendor tarballs missing compiled `dist` folders - blocks build and integration tests
- Stale comment in GameTable.vue:618 references removed state machine (cosmetic)
- Stale comment in combat.ts:72 references "theatre view system" (cosmetic)

**Technical Debt Incurred:**

None.

---

_For current project status, see .planning/PROJECT.md_
